<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Hawkins Trivia</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root{
  --bg:#0b0b0f;--panel:#111219;--text:#fff;--muted:rgba(255,255,255,.7);
  --accent:#b11226;--border:#b11226;--btn:#b11226;--btnText:#fff;
}
body{
  margin:0;font-family:-apple-system,system-ui,Arial,sans-serif;
  background:var(--bg);color:var(--text);
  height:100vh;display:flex;justify-content:center;align-items:center;
}
body.upside{
  --bg:#050507;--panel:#0a0a0f;
  --accent:#ff2448;--border:#ff2448;--btn:#ff2448;--btnText:#0b0b0f;
}
.screen{width:100%;max-width:640px;padding:16px;}
#splash,#winner{text-align:center;}
#splash h1,#winner h1{color:var(--accent);letter-spacing:1px;}
#startBtn,#restartBtn{font-size:18px;padding:14px 22px;border-radius:14px;}
#game,#winner{display:none;}

.card{
  background:var(--panel);border:2px solid var(--border);
  border-radius:18px;padding:26px;text-align:center;font-size:20px;
}
.label{color:var(--accent);font-weight:800;margin-bottom:6px;}
.hint{font-size:12px;color:var(--muted);margin-top:8px;}

.controls{
  margin-top:14px;display:grid;
  grid-template-columns:repeat(2,1fr);gap:10px;
}
button{
  padding:14px;font-size:15px;font-weight:700;
  border-radius:14px;border:none;
  background:var(--btn);color:var(--btnText);
}
button.secondary{
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.18);
}
.wide{grid-column:span 2;}

#difficulty{text-align:center;font-size:18px;margin-bottom:6px;}
.progress{height:10px;background:#222;border-radius:6px;overflow:hidden;margin-bottom:10px;}
.progress-bar{height:100%;width:0%;background:var(--accent);transition:width .3s;}

#scoreboard{font-size:15px;margin-bottom:6px;}
.team-controls{text-align:center;font-size:13px;margin-bottom:6px;}
.team-editor input{
  width:65%;padding:6px;border-radius:8px;border:none;margin-bottom:4px;
}

.toast{
  position:fixed;bottom:20px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.85);
  padding:12px 18px;border-radius:999px;
  font-size:13px;opacity:0;transition:.15s;
}
.toast.show{opacity:1;}

.final-board{font-size:18px;margin-top:10px;}
.final-board div{margin:6px 0;}
</style>
</head>

<body>
<div class="screen">

<div id="splash">
  <h1>HAWKINS TRIVIA</h1>
  <p>1â€“8 players â€¢ Wrong answers = drink ğŸ»</p>
  <button id="startBtn">â–¶ START GAME</button>
</div>

<div id="game">
  <div id="difficulty">ğŸŸ¢ EASY</div>
  <div class="progress"><div class="progress-bar" id="progress"></div></div>

  <div class="team-controls">
    Players / Teams:
    <button class="secondary" onclick="removeTeam()">â–</button>
    <button class="secondary" onclick="addTeam()">â•</button>
    <span id="teamCount"></span>
  </div>

  <div id="scoreboard"></div>
  <div class="team-editor" id="teamEditor"></div>

  <div class="card" id="card">
    <div class="label" id="label">Question</div>
    <div id="text"></div>
    <div class="hint">(tap card to flip)</div>
  </div>

  <div class="controls">
    <button class="secondary" onclick="prevCard()">â¬… Prev</button>
    <button class="secondary" onclick="nextCard()">Next â¡</button>
    <button class="secondary" onclick="shuffle()">ğŸ§© Shuffle</button>
    <button class="secondary" onclick="toggleTheme()">ğŸ‘¾ Upside Down</button>
    <button class="secondary" onclick="toggleSynth()">ğŸ¹ Synth</button>
    <button class="secondary" onclick="skipCard()">â­ Skip</button>
    <button class="secondary" onclick="correctAnswer()">âœ… Correct</button>
    <button class="secondary" onclick="wrongAnswer()">âŒ Wrong</button>
    <button class="wide" onclick="endGame()">ğŸ† End Game</button>
  </div>
</div>

<div id="winner">
  <h1>ğŸ† FINAL SCORES</h1>
  <div id="winnerText" class="final-board"></div>
  <button id="restartBtn" onclick="restart()">ğŸ” Play Again</button>
</div>

</div>

<div class="toast" id="toast"></div>

<script>
/* ================= QUESTIONS (50 TOTAL) ================= */
const EASY = [
 ["What town does Stranger Things take place in?","Hawkins, Indiana"],
 ["What number is tattooed on Elevenâ€™s arm?","11"],
 ["What food does Eleven love the most?","Eggo waffles"],
 ["What is the alternate dimension called?","The Upside Down"],
 ["What game do the boys frequently play?","Dungeons & Dragons"],
 ["Who is the Hawkins police chief?","Jim Hopper"],
 ["What mall is central to Season 3?","Starcourt Mall"],
 ["Who babysits the kids the most?","Steve"],
 ["What year does Season 1 take place?","1983"],
 ["Who says 'Friends donâ€™t lie'?","Eleven"],
 ["What sport does Lucas play?","Basketball"],
 ["What song helps Max escape Vecna?","Running Up That Hill"],
 ["What is Steveâ€™s ice cream shop called?","Scoops Ahoy"],
 ["What flavor Slurpee does Alexei like?","Cherry"],
 ["What color are Dustinâ€™s braces?","Purple"],
 ["What is Elevenâ€™s real name?","Jane"],
 ["What city is Hawkins located in?","Indiana"],
 ["What creature appears in Season 1?","Demogorgon"]
];

const MEDIUM = [
 ["Who is Elevenâ€™s biological mother?","Terry Ives"],
 ["What object does Joyce use to communicate with Will?","Christmas lights"],
 ["What subject does Mr. Clarke teach?","Science"],
 ["What city do Eleven and Kali go to?","Chicago"],
 ["What is Vecnaâ€™s real name?","Henry Creel"],
 ["What number was Kali?","8"],
 ["What movie are the kids watching in Season 3?","Back to the Future"],
 ["Who helps Eleven escape the lab?","Benny Hammond"],
 ["What job does Robin have?","Scoops Ahoy"],
 ["What arcade game do the boys love?","Dig Dug"],
 ["Who is Maxâ€™s stepbrother?","Billy"],
 ["What fairground ride traps Nancy and Jonathan?","Ferris wheel"],
 ["What song plays at the Snow Ball?","Every Breath You Take"],
 ["What is written on the Hellfire Club shirts?","Hellfire Club"],
 ["What was Hopperâ€™s daughterâ€™s name?","Sara"],
 ["What flavor Slurpee does Alexei prefer?","Cherry"]
];

const HARD = [
 ["What was the name of Hawkins Labâ€™s director?","Dr. Brenner"],
 ["What condition affects Elevenâ€™s mother?","Catatonia"],
 ["What alias does Eleven use at school?","Jane Hopper"],
 ["What metal band is Eddie obsessed with?","Metallica"],
 ["What song does Eddie play in the Upside Down?","Master of Puppets"],
 ["What prison is Hopper held in?","Kamchatka"],
 ["What letters does Joyce paint on her wall?","Alphabet"],
 ["What causes the gate to reopen in Season 4?","Vecna"],
 ["What is the Mind Flayerâ€™s original form?","Shadow monster"],
 ["What animal does Dustin think Dart is?","Lizard"],
 ["What number experiment was Eleven after?","Eight"],
 ["What game console do the boys play?","Atari"],
 ["What town does Robin work in Season 4?","Family Video"],
 ["What is Max writing letters for?","In case she dies"],
 ["What color is the Mind Flayer?","Black"],
 ["Who leads the Hellfire Club?","Eddie Munson"]
];

/* ================= STATE ================= */
let difficulty="easy";
let qCount=0;
let pool=[...EASY];
let order=pool.map((_,i)=>i);
let idx=0;
let showAnswer=false;

let teams=[{name:"Player 1",score:0}];
let activeTeam=0;

/* ================= AUDIO (FIXED) ================= */
let audioCtx=null;
let synthOn=false;
let arpTimer=null;
let arpIndex=0;
const arpNotes=[110,165,220,330,247];

function initAudio(){
  if(!audioCtx){
    audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  }
}

function startSynth(){
  if(!audioCtx || arpTimer) return;
  arpTimer=setInterval(()=>{
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    o.type="triangle";
    o.frequency.value=arpNotes[arpIndex%arpNotes.length];
    g.gain.value=0.04;
    o.connect(g); g.connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime+0.25);
    arpIndex++;
  },400);
}

function stopSynth(){
  if(arpTimer){ clearInterval(arpTimer); arpTimer=null; }
}

function toggleSynth(){
  synthOn=!synthOn;
  synthOn?startSynth():stopSynth();
  toast(synthOn?"ğŸ¹ Synth ON":"ğŸ¹ Synth OFF");
}

/* ================= HELPERS ================= */
const $=id=>document.getElementById(id);
const toast=msg=>{
  const t=$("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),1200);
};

function renderTeams(){
  $("teamCount").textContent=teams.length;
  $("scoreboard").innerHTML=teams
    .map((t,i)=>`${i===activeTeam?"ğŸ‘‰ ":""}${t.name}: ${t.score}`)
    .join("<br>");
  $("teamEditor").innerHTML=teams
    .map((t,i)=>`<input value="${t.name}" onchange="teams[${i}].name=this.value;renderTeams()">`)
    .join("");
}

function renderDifficulty(){
  $("difficulty").textContent =
    difficulty==="easy"?"ğŸŸ¢ EASY":difficulty==="medium"?"ğŸŸ¡ MEDIUM":"ğŸ”´ HARD";
  let pct =
    difficulty==="easy"?qCount/15 :
    difficulty==="medium"?(qCount-15)/15 :
    (qCount-30)/20;
  $("progress").style.width=Math.min(100,Math.max(0,pct*100))+"%";
}

function render(){
  $("label").textContent=showAnswer?"Answer":"Question";
  $("text").textContent=pool[order[idx]][showAnswer?1:0];
  renderTeams();
  renderDifficulty();
}

/* ================= GAME FLOW ================= */
function advanceDifficulty(){
  if(qCount===15){
    difficulty="medium"; pool=[...MEDIUM];
    order=pool.map((_,i)=>i); idx=0;
    toast("â¬†ï¸ Medium Difficulty");
  }
  if(qCount===30){
    difficulty="hard"; pool=[...HARD];
    order=pool.map((_,i)=>i); idx=0;
    toast("â¬†ï¸ Hard Difficulty");
  }
}

function flip(){ showAnswer=!showAnswer; render(); }
function nextCard(){
  qCount++;
  advanceDifficulty();
  idx=(idx+1)%order.length;
  showAnswer=false;
  render();
}
function prevCard(){
  idx=(idx-1+order.length)%order.length;
  showAnswer=false; render();
}
function shuffle(){
  order.sort(()=>Math.random()-0.5);
  toast("ğŸ§© Shuffled");
}

function nextTeam(){ activeTeam=(activeTeam+1)%teams.length; }

function correctAnswer(){
  teams[activeTeam].score++;
  nextTeam(); nextCard();
}
function wrongAnswer(){
  teams[activeTeam].score--;
  toast("âŒ Wrong â€” drink ğŸ»");
  nextTeam(); nextCard();
}
function skipCard(){
  teams[activeTeam].score--;
  toast("â­ Skip â€” drink ğŸ»");
  nextTeam(); nextCard();
}

/* ================= TEAMS ================= */
function addTeam(){
  if(teams.length>=8) return toast("Max 8 players");
  teams.push({name:`Player ${teams.length+1}`,score:0});
  renderTeams();
}
function removeTeam(){
  if(teams.length<=1) return toast("At least 1 player");
  teams.pop(); activeTeam=0;
  renderTeams();
}

/* ================= END / TIEBREAK ================= */
function endGame(){
  const max=Math.max(...teams.map(t=>t.score));
  const winners=teams.filter(t=>t.score===max);
  if(winners.length>1){
    toast("Tie! Sudden Death ğŸ’€");
    difficulty="hard"; pool=[...HARD];
    order=pool.map((_,i)=>i); idx=0;
    render(); return;
  }
  $("game").style.display="none";
  $("winner").style.display="block";
  $("winnerText").innerHTML=teams
    .map(t=>`<div>${t.name}: ${t.score}</div>`).join("");
}

function restart(){ location.reload(); }

function toggleTheme(){
  document.body.classList.toggle("upside");
}

/* ================= START ================= */
$("card").onclick=flip;
$("startBtn").onclick=()=>{
  initAudio();
  $("splash").style.display="none";
  $("game").style.display="block";
  render();
};
</script>
</body>
</html>